/*!CK:605246908!*//*1433198916,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["nLKih"]); }

__d("legacy:photos-clusters-js",["PhotosClusters_DEPRECATED"],function(a,b,c,d){b.__markCompiled&&b.__markCompiled();a.PhotosClusters=b('PhotosClusters_DEPRECATED');},3);
__d("SaveCaretMenuItem",["Banzai","CSS","DOM","EntstreamFeedObject","EntstreamFeedObjectFollowup","Event","MenuItem","SaveState","SaveStateHandler","cx","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();var r='saved_for_later:caret_action',s='imp';for(var t in m)if(m.hasOwnProperty(t))v[t]=m[t];var u=m===null?null:m.prototype;v.prototype=Object.create(u);v.prototype.constructor=v;v.__superConstructor__=m;function v(w){"use strict";m.call(this,w);this._updateData();this.getRoot();l.listen(this._anchor,'error',this.handleError.bind(this));o.listen(w.primarysaveid,function(x){this._updateData();this._doRender(x);}.bind(this));}v.prototype.handleClick=function(){"use strict";var w=u.handleClick.call(this),x=j.getRoot(q(this._data.storydomid));if(this._data.isSaveAction){o.saving(this._data.allsaveids);x&&k.addFollowup(x,this._data.savefollowupmarkup,"_521o");}else{o.unsaving(this._data.allsaveids);var y=k.getFollowup(x);y&&k.removeFollowup(x);}return w;};v.prototype.handleError=function(){"use strict";if(this._data.isSaveAction){o.saved(this._data.allsaveids);}else o.unsaved(this._data.allsaveids);};v.prototype._updateData=function(){"use strict";this._data.isSaveAction=o.isSaveAction(this._data.primarysaveid);if(this._data.isSaveAction){this._data.markup=this._data.savemarkup;this._data.ajaxify=this._data.saveajaxify;this._data.title=this._data.savetitle;}else{this._data.markup=this._data.unsavemarkup;this._data.ajaxify=this._data.unsaveajaxify;this._data.title=this._data.unsavetitle;}};v.prototype._doRender=function(w){"use strict";if(!this._root)return;switch(w){case n.SAVING:case n.UNSAVING:h.addClass(this._root,"_5arm");setTimeout(this.disable.bind(this),10);break;case n.SAVED:case n.UNSAVED:h.removeClass(this._root,"_5arm");setTimeout(this.enable.bind(this),10);break;}i.replace(this._anchor,this._renderItemContent());l.listen(this._anchor,'error',this.handleError.bind(this));};v.prototype.onShow=function(){"use strict";var w=this._data.logdata;g.post(r,{action:s,surface:w.surface,story_id:w.story_id,is_save:this._data.isSaveAction});};e.exports=v;},null);